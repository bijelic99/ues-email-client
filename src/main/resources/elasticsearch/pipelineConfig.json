{
  "description": "To get attachment information",
  "processors": [
    {
      "foreach": {
        "field": "attachments",
        "processor": {
          "attachment": {
            "indexed_chars": 10000,
            "field": "_ingest._value.data",
            "target_field": "_ingest._value.metadata",
            "indexed_chars_field": "max_size",
            "properties": ["date", "language","content"],
            "ignore_missing": true
          }
        }
      }
    },
    {
      "foreach": {
        "field": "attachments",
        "processor": {
          "remove": {
            "field": "_ingest._value.data",
            "ignore_missing": true
          }
        }
      }
    }
  ]
}